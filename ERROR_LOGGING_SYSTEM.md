# üîç –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

## –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 1. **–í—Å–µ JavaScript –æ—à–∏–±–∫–∏**
- –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (`window.addEventListener('error')`)
- Unhandled Promise rejections
- Runtime –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ

### 2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏**
- ‚ùå –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- üìã Stack trace (–ø–µ—Ä–≤—ã–µ 800 —Å–∏–º–≤–æ–ª–æ–≤)
- üìç URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- üë§ User ID –∏ username (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
- ‚è∞ Timestamp
- üåê User Agent (–±—Ä–∞—É–∑–µ—Ä, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)

### 3. **–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
- üîê –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- üë§ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –Ω–∏–∫–Ω–µ–π–º
- üì± –†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞
- üåê –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### 4. **–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π**
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5-10 –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –æ—à–∏–±–∫–æ–π
- Timestamp –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –æ—à–∏–±–æ–∫

### üö® **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ** (–æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –º–µ—Ç–∫–æ–π [–ö–†–ò–¢–ò–ß–ù–û])
- `is not defined` - –Ω–µ–æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `is not a function` - –ø–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–æ–≤–∞ –Ω–µ-—Ñ—É–Ω–∫—Ü–∏–∏
- `Cannot read` - –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ undefined/null
- Unhandled Promise rejection

### üî¥ **–û–±—ã—á–Ω—ã–µ**
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏

## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∞–º–∞

–ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ—à–∏–±–∫–∏:
- `ResizeObserver loop` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `Script error` - CORS –æ—à–∏–±–∫–∏ –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- `Extension context invalidated` - –æ—à–∏–±–∫–∏ –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- `Non-Error promise rejection` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ rejection'—ã

## –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è

- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–∞—â–µ —á–µ–º **—Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥**
- –ö–µ—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

## API endpoint

`POST /api/log-error`

```typescript
interface ErrorLog {
  message: string;
  stack?: string;
  url: string;
  userAgent: string;
  timestamp: string;
  userId?: string;
  username?: string;
  type?: string;
  critical?: boolean;
  appState?: {
    isAuthorized: boolean;
    hasNickname: boolean;
    currentPage: string;
    screenSize: string;
    online: boolean;
  };
  recentActions?: Array<{
    action: string;
    details: any;
    timestamp: string;
  }>;
}
```

## Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:
```
üö® [–ö–†–ò–¢–ò–ß–ù–û] –û—à–∏–±–∫–∞ –Ω–∞ —Å–∞–π—Ç–µ!

üìç URL: https://anonimka.kz/webapp
‚è∞ –í—Ä–µ–º—è: 2025-11-28T18:37:22.469Z
üë§ User ID: 1234567890 (@username)

‚ùå –û—à–∏–±–∫–∞:
Can't find variable: customConfirmCancel

üåê Browser:
Mozilla/5.0 (iPhone; CPU iPhone OS 18_6_2...)

üìã Stack:
@https://anonimka.kz/webapp/app.js:10942:28

üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ:
üîê –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ‚úÖ
üë§ –ù–∏–∫–Ω–µ–π–º: ‚úÖ
üì± –≠–∫—Ä–∞–Ω: 390x844
üåê –û–Ω–ª–∞–π–Ω: ‚úÖ

üë£ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. [18:36:45] saveNickname {step: 'started'}
2. [18:37:10] openProfile {userId: 123}
3. [18:37:15] likeProfile {profileId: 456}
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
ADMIN_CHAT_ID=your_telegram_id
```

## –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### `window.logUserAction(action, details)`
–õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏—Å—Ç–æ—Ä–∏—é
```javascript
window.logUserAction('createAd', { category: '–∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞' });
```

### `window.logError(message, error)`
–†—É—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
```javascript
window.logError('Custom error', new Error('Something went wrong'));
```

### `window.safeAsync(actionName, asyncFn)`
–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ async —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∞–≤—Ç–æ–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
```javascript
await window.safeAsync('loadUserData', async () => {
  const response = await fetch('/api/user');
  return response.json();
});
```

### `window.getActionHistory()`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–µ–π—Å—Ç–≤–∏–π –≤ –∫–æ–Ω—Å–æ–ª–∏

### `window.getErrorCacheInfo()`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–µ—à –æ—à–∏–±–æ–∫

### `window.clearErrorCache()`
–û—á–∏—â–∞–µ—Ç –∫–µ—à –æ—à–∏–±–æ–∫

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
async function someFunction() {
  window.logUserAction('someFunction', { param: 'value' });
  
  try {
    // –≤–∞—à –∫–æ–¥
    const result = await fetch('/api/endpoint');
    window.logUserAction('someFunction', { success: true });
    return result;
  } catch (error) {
    // –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ window.onerror
    console.error('Error:', error);
    throw error;
  }
}

// –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å safeAsync
async function someFunction() {
  return await window.safeAsync('someFunction', async () => {
    const result = await fetch('/api/endpoint');
    return result;
  });
}
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è (30 —Å–µ–∫ TTL)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∞–º–∞
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ / –æ–±—ã—á–Ω—ã–µ)
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ No-cache –¥–ª—è webapp —Ñ–∞–π–ª–æ–≤

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –í–≤–µ–¥–∏—Ç–µ: `throw new Error('Test error')`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
4. –í–≤–µ–¥–∏—Ç–µ: `window.getActionHistory()` - —É–≤–∏–¥–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –¥–µ–π—Å—Ç–≤–∏–π
