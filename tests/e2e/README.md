# E2E –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Anonimka.kz

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç–µ—Ä —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º (—Å–º–µ–Ω–∞ –Ω–∏–∫–Ω–µ–π–º–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- –°–∏—Å—Ç–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–º–∏—Ä–æ–≤–æ–π —á–∞—Ç, –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ñ–∞–ª–æ–±—ã –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á—ë—Ç—ã –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd anonimka-nextjs
npm install
```

### 2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ ts-node —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
npm install -g ts-node
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
npm run test:e2e
```

–¢–µ—Å—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ `http://localhost:3000`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```bash
npm run test:e2e:prod
```

–¢–µ—Å—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ `https://anonimka.kz`

### –ö–∞—Å—Ç–æ–º–Ω—ã–π URL

```bash
API_URL=https://your-domain.com npm run test:e2e
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á—ë—Ç–∞

–û—Ç—á—ë—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `test-reports/report-YYYY-MM-DD-HH-mm-ss-SSS.json`

```json
{
  "timestamp": "2025-12-04T12:34:56.789Z",
  "totalTests": 45,
  "passed": 43,
  "failed": 2,
  "errors": 0,
  "duration": 15234,
  "results": [
    {
      "name": "Create ad (TestBot1)",
      "status": "PASS",
      "duration": 342
    },
    {
      "name": "Send private message",
      "status": "FAIL",
      "error": "429: Too Many Requests",
      "duration": 1023
    }
  ]
}
```

## –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### User 1 (TestBot1)
- –°–º–µ–Ω–∞ –Ω–∏–∫–Ω–µ–π–º–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ User 2
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

### User 2 (TestBot2)
- –°–º–µ–Ω–∞ –Ω–∏–∫–Ω–µ–π–º–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è User 1

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –º–∏—Ä–æ–≤–æ–π —á–∞—Ç
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∂–∞–ª–æ–±—ã –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### PASS ‚úÖ
–§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### FAIL ‚ùå
–§—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É, –Ω–æ –∑–∞–ø—Ä–æ—Å –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω (—Å—Ç–∞—Ç—É—Å –∫–æ–¥ 4xx)

### ERROR üí•
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç–∞—Ç—É—Å –∫–æ–¥ 5xx –∏–ª–∏ —Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—á—ë—Ç –≤ –∫–æ–Ω—Å–æ–ª—å

```bash
npm run test:e2e 2>&1 | tee test.log
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–º –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏

```bash
npm run test:e2e > test.log 2>&1 &
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–∫–∞–∂–¥—ã–π —á–∞—Å)

```bash
while true; do
  npm run test:e2e:prod
  sleep 3600
done
```

## –í–∏–¥–µ–æ-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
watch -n 1800 'npm run test:e2e:prod >> test-reports/automated.log 2>&1'
```

## –û—á–∏—Å—Ç–∫–∞

–í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤.

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞:

1. –ù–∞–π—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î (ID 999001, 999002)
2. –£–¥–∞–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "Module not found: ts-node"

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω–æ:
```bash
npm install -g ts-node
```

### "Cannot find module 'axios'"

–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

### –¢–µ—Å—Ç—ã –Ω–µ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ API

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –í–µ—Ä–Ω—ã–π URL –≤ `API_URL` –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
