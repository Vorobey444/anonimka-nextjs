-- Migration 009: Seed demo ads with quality cringe content
-- Date: 2025-11-07
-- Purpose: Fill DB with 3-5 demo ads per city for better UX

BEGIN;

-- Helper: Generate random user_token
CREATE OR REPLACE FUNCTION random_token() RETURNS TEXT AS $$
  SELECT encode(gen_random_bytes(32), 'hex');
$$ LANGUAGE SQL;

-- Clear existing demo ads (optional, comment out if you want to keep old data)
-- DELETE FROM ads WHERE nickname LIKE 'Демо:%';

-- Астана (5 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Смайлик', 'Женщина', 'Девушку', 'Путешествия', 25, 35, 27, 'Астана', 'KZ', 'Обычное', 
   'Хочу сорваться в Чарынский каньон, но мои подруги скучные. Кто рискнёт со мной без плана и с термосом кофе?', NOW() - INTERVAL '2 hours'),
   
  (random_token(), 'Кофейный маньяк', 'Женщина', 'Девушку', 'Дружба', 23, 30, 26, 'Астана', 'KZ', 'Стройное',
   'Ищу компанию для кофеен и обсуждения того, почему я снова забыла выключить утюг. Но не забыла про кофе!', NOW() - INTERVAL '5 hours'),
   
  (random_token(), 'Звёздочка', 'Женщина', 'Пару', 'Дружба', 28, 40, 31, 'Астана', 'KZ', 'Спортивное',
   'Ищу пару для настолок и вечеров с пиццей. Главное — без токсичности и с чувством юмора!', NOW() - INTERVAL '1 day'),
   
  (random_token(), 'Облачко', 'Женщина', 'Девушку', 'Переписка', 20, 28, 24, 'Астана', 'KZ', 'Обычное',
   'Хочу найти человека, с которым можно переписываться в 3 ночи про смысл жизни и мемы одновременно.', NOW() - INTERVAL '3 hours'),
   
  (random_token(), 'Авантюристка', 'Женщина', 'Девушку', 'Путешествия', 22, 32, 28, 'Астана', 'KZ', 'Стройное',
   'Планирую поездку в горы Кольсай. Нужна смелая подруга, которая не боится селфи на краю обрыва!', NOW() - INTERVAL '6 hours');

-- Алматы (5 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Ветер в голове', 'Женщина', 'Пару', 'Дружба', 25, 40, 25, 'Алматы', 'KZ', 'Обычное',
   'Люблю настолки, вино из пакета и спорить, кто первый сдался в UNO. Если вы пара без драмы — давайте дружить!', NOW() - INTERVAL '4 hours'),
   
  (random_token(), 'Сладкоежка', 'Женщина', 'Девушку', 'Дружба', 22, 30, 27, 'Алматы', 'KZ', 'Плотное',
   'Нужна подруга для похода по кафешкам и обсуждения, почему я опять купила торт, хотя собиралась на диету.', NOW() - INTERVAL '8 hours'),
   
  (random_token(), 'Мечтательница', 'Женщина', 'Девушку', 'Переписка', 18, 26, 23, 'Алматы', 'KZ', 'Стройное',
   'Хочу просто переписываться о книгах, фильмах и о том, почему кошки лучше людей. Без обязательств!', NOW() - INTERVAL '12 hours'),
   
  (random_token(), 'Энерджайзер', 'Женщина', 'Девушку', 'Встречи', 24, 32, 29, 'Алматы', 'KZ', 'Спортивное',
   'Ищу активную подругу для походов, велопрогулок и внезапных решений съездить на Чимбулак в выходные!', NOW() - INTERVAL '2 hours'),
   
  (random_token(), 'Тихоня', 'Женщина', 'Пару', 'Дружба', 30, 45, 34, 'Алматы', 'KZ', 'Обычное',
   'Люблю уютные вечера с фильмами и чаем. Ищу пару, которая тоже предпочитает диван шумным тусовкам.', NOW() - INTERVAL '1 day');

-- Шымкент (4 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Капризуля', 'Женщина', 'Девушку', 'Дружба', 20, 32, 30, 'Шымкент', 'KZ', 'Обычное',
   'Нужна подруга, чтобы жаловаться на жизнь, потом смеяться, потом опять жаловаться. И поесть шаурмы. Без осуждения!', NOW() - INTERVAL '7 hours'),
   
  (random_token(), 'Солнышко', 'Женщина', 'Девушку', 'Встречи', 23, 30, 26, 'Шымкент', 'KZ', 'Стройное',
   'Ищу компанию для прогулок по паркам, фоточек и болтовни обо всём на свете. Главное — позитив!', NOW() - INTERVAL '5 hours'),
   
  (random_token(), 'Bookworm', 'Женщина', 'Девушку', 'Переписка', 25, 35, 28, 'Шымкент', 'KZ', 'Обычное',
   'Читаю всё подряд и хочу обсуждать книги с кем-то, кто не заснёт на втором предложении.', NOW() - INTERVAL '10 hours'),
   
  (random_token(), 'Романтик', 'Женщина', 'Пару', 'Дружба', 27, 38, 32, 'Шымкент', 'KZ', 'Плотное',
   'Ищу пару для совместных ужинов, настольных игр и разговоров до утра. Без токсичности, только тепло!', NOW() - INTERVAL '1 day');

-- Караганда (4 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Печенька', 'Женщина', 'Девушку', 'Путешествия', 27, 38, 33, 'Караганда', 'KZ', 'Обычное',
   'Мечтаю в ноябре сорваться в Боровое — просто посидеть у воды и притвориться, что у меня отпуск. Кто со мной?', NOW() - INTERVAL '3 hours'),
   
  (random_token(), 'Весёлая', 'Женщина', 'Девушку', 'Дружба', 22, 30, 25, 'Караганда', 'KZ', 'Стройное',
   'Ищу подругу для кино, кофе и обсуждения того, почему я снова купила вещь, которая мне не нужна.', NOW() - INTERVAL '9 hours'),
   
  (random_token(), 'Луна', 'Женщина', 'Девушку', 'Переписка', 20, 28, 24, 'Караганда', 'KZ', 'Обычное',
   'Хочу просто переписываться по вечерам, делиться мемами и жаловаться на понедельники.', NOW() - INTERVAL '6 hours'),
   
  (random_token(), 'Искорка', 'Женщина', 'Пару', 'Встречи', 26, 35, 29, 'Караганда', 'KZ', 'Спортивное',
   'Ищу пару для спонтанных прогулок, настольных игр и экспериментов с кухней. Главное — без скуки!', NOW() - INTERVAL '4 hours');

-- Актобе (3 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Непоседа', 'Женщина', 'Девушку', 'Дружба', 21, 29, 26, 'Актобе', 'KZ', 'Стройное',
   'Ищу подругу для шопинга, кофе и обсуждения того, почему мы снова не выспались.', NOW() - INTERVAL '11 hours'),
   
  (random_token(), 'Мурка', 'Женщина', 'Девушку', 'Переписка', 23, 31, 27, 'Актобе', 'KZ', 'Обычное',
   'Хочу переписываться о котиках, сериалах и о том, как сложно быть взрослым.', NOW() - INTERVAL '5 hours'),
   
  (random_token(), 'Радуга', 'Женщина', 'Пару', 'Дружба', 28, 40, 31, 'Актобе', 'KZ', 'Плотное',
   'Ищу пару для вечеров с настолками, пиццей и разговорами о жизни. Только без драмы!', NOW() - INTERVAL '2 days');

-- Костанай (3 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Тучка', 'Женщина', 'Пару', 'Дружба', 30, 45, 29, 'Костанай', 'KZ', 'Обычное',
   'Иногда просто хочется собраться на шашлыки, поспорить о фильмах и не объяснять, почему у меня кот по кличке Директор.', NOW() - INTERVAL '8 hours'),
   
  (random_token(), 'Снежинка', 'Женщина', 'Девушку', 'Встречи', 24, 32, 28, 'Костанай', 'KZ', 'Стройное',
   'Ищу компанию для прогулок, фотосессий и спонтанных поездок за город. Без планов — по настроению!', NOW() - INTERVAL '1 day'),
   
  (random_token(), 'Загадка', 'Женщина', 'Девушку', 'Переписка', 22, 30, 25, 'Костанай', 'KZ', 'Обычное',
   'Хочу переписываться с кем-то, кто тоже любит философствовать в 2 ночи и смеяться над глупыми шутками.', NOW() - INTERVAL '14 hours');

-- Тараз (3 ads)
INSERT INTO ads (user_token, nickname, gender, target, goal, age_from, age_to, my_age, city, country, body_type, text, created_at)
VALUES
  (random_token(), 'Бабочка', 'Женщина', 'Девушку', 'Дружба', 20, 28, 24, 'Тараз', 'KZ', 'Стройное',
   'Ищу подругу для кофе, шопинга и обсуждения того, почему мы всегда опаздываем.', NOW() - INTERVAL '6 hours'),
   
  (random_token(), 'Звезда', 'Женщина', 'Девушку', 'Переписка', 25, 33, 29, 'Тараз', 'KZ', 'Обычное',
   'Хочу просто переписываться, делиться мемами и обсуждать сериалы. Без обязательств!', NOW() - INTERVAL '9 hours'),
   
  (random_token(), 'Улыбка', 'Женщина', 'Пару', 'Встречи', 27, 38, 32, 'Тараз', 'KZ', 'Плотное',
   'Ищу пару для вечеров с настолками, вином и разговорами о жизни. Главное — искренность!', NOW() - INTERVAL '1 day');

-- Drop helper function
DROP FUNCTION IF EXISTS random_token();

COMMIT;

-- Verification
DO $$
DECLARE
    demo_count INTEGER;
BEGIN
    SELECT COUNT(*) INTO demo_count FROM ads;
    RAISE NOTICE '✅ Migration 009 complete! Total ads in DB: %', demo_count;
END $$;
