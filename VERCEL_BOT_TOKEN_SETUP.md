# Настройка TELEGRAM_BOT_TOKEN в Vercel

## Проблема
При отправке сообщения на объявление автор не получает уведомление в Telegram, потому что в Vercel не настроена переменная окружения `TELEGRAM_BOT_TOKEN`.

## Решение

### 1. Откройте настройки проекта в Vercel
1. Перейдите на https://vercel.com/vorobey444s-projects
2. Выберите проект **anonimka-nextjs**
3. Нажмите **Settings** (Настройки)
4. В левом меню выберите **Environment Variables** (Переменные окружения)

### 2. Добавьте переменную TELEGRAM_BOT_TOKEN

Нажмите кнопку **Add New** и введите:

- **Name (Имя)**: `TELEGRAM_BOT_TOKEN`
- **Value (Значение)**: `8105244538:AAFosyTcD8uPuwArnYgBO-IVeSThzuxbLhY`
- **Environment (Окружение)**: Выберите все:
  - ✅ Production
  - ✅ Preview  
  - ✅ Development

### 3. Сохраните и передеплойте

1. Нажмите **Save**
2. Vercel предложит передеплоить проект - нажмите **Redeploy**
3. Дождитесь завершения деплоя (~1-2 минуты)

### 4. Проверка

После деплоя:
1. Откройте https://anonimka.kz/webapp/
2. Найдите любое объявление (не своё)
3. Нажмите "Написать автору"
4. Введите сообщение
5. ✅ Автор объявления должен получить уведомление в боте

## Как работает система сообщений

```
Пользователь A                    API                         Пользователь B
(отправитель)              /api/send-message               (автор объявления)
     │                           │                                │
     ├─ Открывает объявление     │                                │
     ├─ Нажимает "Написать"      │                                │
     ├─ Вводит текст ───────────>│                                │
     │                           ├─ Сохраняет в Supabase         │
     │                           ├─ Отправляет в Telegram Bot ──>│
     │                           │                                ├─ Получает уведомление
     ├─ Видит "Сообщение         │                                ├─ Видит кнопки:
     │   отправлено!"            │                                │  • Создать чат
     │                           │                                │  • Просмотреть объявление
```

## Текущий статус

- ✅ API роут `/api/send-message` создан
- ✅ Бот запущен и работает
- ✅ Функция `contactAuthor()` в WebApp работает
- ✅ Локально `.env.local` настроен
- ❌ **В Vercel переменная не добавлена** ← нужно исправить

## После настройки

Когда вы добавите `TELEGRAM_BOT_TOKEN` в Vercel, система сообщений будет работать полностью:

1. **Пользователь пишет** → Сообщение сохраняется в базу
2. **API отправляет уведомление** → Автор получает в Telegram
3. **Автор нажимает "Создать чат"** → Начинается приватный анонимный чат
4. **Оба общаются** через бота анонимно

---

**Важно:** После добавления переменной обязательно сделайте Redeploy проекта!
